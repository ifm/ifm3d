variables:
  VERSION: 
    description: "Release version in format vx.x.x"

release:update_version:
  stage: release
  image: python:3
  tags: [shared_docker]
  variables:
    HTTP_PROXY: ${CI_HTTP_PROXY}
    HTTPS_PROXY: ${CI_HTTPS_PROXY}
    NO_PROXY: ${CI_NO_PROXY}
  before_script:
  - |
    apt-get -y update
    apt-get -y install git
    git config --global user.email "support.robotics@ifm.com"
    git config --global user.name "ifm-csr"

  script:
  - |
    python3 scripts/release/update_version.py --version=v1.2.1
    git checkout -b Release/${VERSION}
    git commit -a -m "update document for release-${VERSION}"
    git push -o merge_request.create -o merge_request.target=main origin Release/${VERSION}
    
  rules:
    - !reference [.manual, rules]
